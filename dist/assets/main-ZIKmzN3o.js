import{g as m}from"./supabase-BFUGbfn1.js";let l=[],s=null;const g={"battle-royale":"images/eat-chicken-battle-royale.png/image.png","kiss-marks":"images/second-kiss-mark.png/image.png","party-psychology":"images/party-psychology.png/image.png",wisdom:"images/jiubao-quick-wit.png/image.png","man-di-piao-ling":"images/man-di-piao-ling.png/image.png","moon-night":"images/jiubao-yuanyue-ye/image.png","love-battle":"images/chun-ai-da-zuo-zhan.png/image.png",poker:"images/de-zhou-pu-ke-pai.png/image.png"};async function r(){try{console.log("Loading games from database...");const e=await m();console.log("Games loaded:",e),l=e,u()}catch(e){console.error("Error loading games:",e),document.getElementById("loadingState").innerHTML=`
                    <div class="text-center py-8">
                        <p class="text-red-400 mb-4">加载游戏失败</p>
                        <button onclick="location.reload()" class="bg-red-500 text-white px-4 py-2 rounded">重试</button>
                    </div>
                `}}function u(){const e=document.getElementById("loadingState"),t=document.getElementById("mainGameSection"),d=document.getElementById("gameGrid");e.style.display="none";const a=l.find(o=>o.category_tag==="drinking-topics");a&&(t.innerHTML=`
                    <div class="game-card" onclick="showGamePreview('${a.category_tag}')">
                        <div class="main-game-card main-game-fallback">
                            <div class="main-game-title">${a.name}</div>
                            <div class="main-game-subtitle">${a.description}</div>
                        </div>
                    </div>
                `,t.style.display="block");const c=l.filter(o=>o.category_tag!=="drinking-topics");d.innerHTML=c.map(o=>{const n=g[o.category_tag];return`
                    <div class="game-card ${o.category_tag!=="drinking-topics"?"coming-soon":""}" onclick="showGamePreview('${o.category_tag}')">
                        <div class="game-card-content" style="${n?`background-image: url('${n}')`:"background: linear-gradient(135deg, #666 0%, #333 100%)"}">
                            <!-- Image background is set via style -->
                        </div>
                    </div>
                `}).join(""),d.style.display="grid"}window.showGamePreview=function(e){console.log("Showing preview for game:",e),s=e;const t=l.find(n=>n.category_tag===e);if(!t){console.error("Game not found:",e);return}document.getElementById("modalTitle").textContent=t.name,document.getElementById("modalDescription").textContent=t.description||"",document.getElementById("modalPlayers").textContent=t.players||"未知",document.getElementById("modalDuration").textContent=t.duration||"未知";const d=document.getElementById("modalFeatures");d.innerHTML="",t.features&&Array.isArray(t.features)&&t.features.forEach(n=>{const i=document.createElement("span");i.className="feature-tag",i.textContent=n,d.appendChild(i)});const a=document.getElementById("startGameBtn");if(e==="drinking-topics"){a.textContent="开始游戏",a.disabled=!1;const n=document.getElementById("modalTitle").querySelector(".coming-soon-badge");n&&n.remove()}else{a.textContent="即将推出",a.disabled=!0;const n=document.getElementById("modalTitle");if(!n.querySelector(".coming-soon-badge")){const i=document.createElement("span");i.className="coming-soon-badge",i.textContent="即将推出",n.appendChild(i)}}document.getElementById("gameModal").classList.add("active"),document.body.style.overflow="hidden"};window.closeModal=function(){document.getElementById("gameModal").classList.remove("active"),s=null,document.body.style.overflow=""};window.startSelectedGame=function(){if(console.log("Starting game:",s),!s){console.error("No game selected");return}s==="drinking-topics"?(console.log("Navigating to drinking-game.html"),closeModal(),window.location.href="drinking-game.html"):console.log("Game is coming soon, not navigating")};document.getElementById("gameModal").addEventListener("click",function(e){e.target===this&&closeModal()});document.addEventListener("keydown",function(e){e.key==="Escape"&&closeModal()});document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".game-card").forEach(t=>{t.addEventListener("touchstart",function(){this.style.transform="translateY(-2px) scale(0.98)"}),t.addEventListener("touchend",function(){this.style.transform=""})})});r();
